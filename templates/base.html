<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}아무 말 대잔치{% endblock %}</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- 기존 커스텀 CSS (커스텀 스타일 유지) -->
    <link rel="stylesheet" href="/static/css/common.css">
    <style>
        /* Tailwind와 충돌 방지 및 커스텀 설정 */
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
        }
        /* Toast Container 위치 (Tailwind로 대체 가능하지만 기존 로직 유지) */
        .toast-container {
            z-index: 9999;
        }
    </style>
    {% block extra_css %}{% endblock %}
</head>
<body class="bg-gray-100 min-h-screen">
    <!-- 공통 헤더 -->
    <div class="header bg-white border-b border-black px-5 py-4 text-center relative">
        {% block header_left %}{% endblock %}
        
        <h1 class="text-xl font-medium">
            <a href="{% block home_link %}/posts{% endblock %}" class="no-underline text-black">아무 말 대잔치</a>
        </h1>
        
        {% block header_right %}
        <div class="user-icon absolute right-5 top-1/2 -translate-y-1/2 w-[30px] h-[30px] rounded-full bg-gray-400 cursor-pointer" id="userIcon"></div>
        <div class="dropdown-menu absolute right-5 top-[60px] bg-white border border-gray-300 rounded shadow-lg hidden z-50 w-40" id="dropdownMenu">
            <button onclick="location.href='/profile/edit'" class="block w-full text-left px-5 py-3 hover:bg-gray-100 text-sm">회원정보수정</button>
            <button onclick="location.href='/password/edit'" class="block w-full text-left px-5 py-3 hover:bg-gray-100 text-sm">비밀번호수정</button>
            <button onclick="api.auth.logout()" class="block w-full text-left px-5 py-3 hover:bg-gray-100 text-sm">로그아웃</button>
        </div>
        {% endblock %}
    </div>

    <!-- 메인 콘텐츠 -->
    <div class="container mx-auto bg-white min-h-screen">
        {% block content %}
        {% endblock %}
    </div>

    <!-- 공통 스크립트 -->
    <script src="/static/js/api.js"></script>
    <script>
        // 헤더 드롭다운 로직 (모든 페이지 공통)
        const userIcon = document.getElementById('userIcon');
        const dropdownMenu = document.getElementById('dropdownMenu');
        
        if (userIcon && dropdownMenu) {
            userIcon.addEventListener('click', function(e) {
                e.stopPropagation();
                dropdownMenu.classList.toggle('hidden');
                dropdownMenu.classList.toggle('block');
            });

            document.addEventListener('click', function() {
                dropdownMenu.classList.add('hidden');
                dropdownMenu.classList.remove('block');
            });
            
            // 프로필 이미지 로드
            utils.loadUserProfileImage();
        }
    </script>
    {% block extra_js %}{% endblock %}
</body>
</html>
